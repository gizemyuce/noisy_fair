tensor([ 0.0295,  0.0003,  0.0009,  ...,  0.0009, -0.0035,  0.0008])
CMM train_err=0.0, err=45.03499984741211
1.1418157815933228
1.0859700441360474
1.0354290008544922
0.9897912740707397
0.9486792683601379
0.9117317199707031
0.8786214590072632
0.8490372896194458
0.822684645652771
0.7992926239967346
0.7785989046096802
0.7603648900985718
0.7443571090698242
0.7303622961044312
0.7181799411773682
0.7076224088668823
0.698512077331543
0.6906882524490356
0.6839989423751831
0.6783058643341064
0.6734832525253296
0.6694175004959106
0.6660037040710449
0.6631510257720947
0.6607770323753357
0.6588076949119568
0.6571836471557617
0.6558473110198975
0.6547515392303467
0.6538569331169128
0.6531283259391785
0.6525372266769409
0.6520581245422363
0.6516714096069336
0.6513586044311523
0.6511080265045166
0.6509068012237549
0.6507453918457031
0.6506162881851196
0.6505128145217896
0.6504303216934204
0.6503645777702332
0.6503125429153442
0.6502707004547119
0.6502370834350586
0.6502111554145813
0.6501902341842651
0.6501739025115967
0.6501603722572327
0.650149941444397
0.6501417756080627
0.6501352787017822
0.6501299142837524
0.6501258611679077
0.650122344493866
0.6501199007034302
0.6501173377037048
0.6501162052154541
0.6501147747039795
0.6501140594482422
0.6501129269599915
0.6501123309135437
0.6501114964485168
0.6501113176345825
0.6501110196113586
0.6501110792160034
0.65011066198349
0.6501103043556213
0.6501102447509766
0.6501106023788452
0.6501101851463318
0.6501098871231079
0.6501099467277527
0.6501100063323975
0.650110125541687
0.6501098275184631
0.6501098871231079
tensor([ 0.0676,  0.0003,  0.0025,  ...,  0.0023, -0.0084,  0.0018],
       requires_grad=True)
w=1.0, train_err=0.0, err=45.17499923706055
====================l1=========================
CMM train_err=0.0, err=5.759999752044678
C:\Users\gizem\anaconda3\envs\iw\lib\site-packages\sklearn\svm\_base.py:1206: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations.
  warnings.warn(
3.3610455989837646
3.329864025115967
3.31899094581604
3.312924385070801
3.3094019889831543
3.306896209716797
3.304841995239258
3.302640676498413
3.3010878562927246
3.299924373626709
3.2989399433135986
3.2974770069122314
3.2965517044067383
3.2957804203033447
3.2952346801757812
3.294044017791748
3.29378604888916
3.2930517196655273
3.292581081390381
3.291682243347168
3.291778087615967
3.2914512157440186
3.2906341552734375
3.289869785308838
3.289492130279541
3.288984775543213
3.288898468017578
3.2890119552612305
3.288301467895508
3.2881393432617188
3.2879209518432617
3.287797212600708
3.2874412536621094
3.2869391441345215
3.2867398262023926
3.2864022254943848
3.2861709594726562
3.2858028411865234
3.286269187927246
3.2856836318969727
3.2860124111175537
3.2851929664611816
3.2855772972106934
3.285576581954956
3.2849271297454834
3.284850597381592
3.2849910259246826
3.284944534301758
3.284719944000244
3.284264087677002
3.28452205657959
3.2843732833862305
3.2844014167785645
3.284104347229004
3.283957004547119
3.2838995456695557
3.283735752105713
3.2838778495788574
3.2840261459350586
3.283905506134033
3.2833971977233887
3.2835693359375
3.2834906578063965
3.283555507659912
3.2832188606262207
3.283377170562744
3.2832772731781006
3.2833046913146973
3.2830166816711426
3.283144474029541
3.2831430435180664
3.2832424640655518
3.283050537109375
3.2829370498657227
3.282951593399048
3.282561779022217
3.282909870147705
3.2828822135925293
3.283099889755249
3.282869815826416
3.2830276489257812
3.2830047607421875
3.282700300216675
3.28273606300354
3.2825512886047363
3.2825186252593994
3.2828383445739746
3.2826364040374756
3.2823524475097656
3.2821927070617676
3.28269362449646
3.282519578933716
3.282348155975342
3.282674551010132
3.2825536727905273
3.2825655937194824
3.282341241836548
3.282548427581787
3.2827749252319336
3.282277822494507
3.2825098037719727
3.2824554443359375
3.2825989723205566
3.282881259918213
3.2828264236450195
3.2826130390167236
3.2826809883117676
3.2825570106506348
3.2825942039489746
3.2825942039489746
3.2825851440429688
3.282489776611328
3.2823710441589355
3.2820510864257812
3.282163143157959
3.2824783325195312
3.282175064086914
3.282266855239868
3.2822346687316895
3.2822539806365967
3.282378673553467
3.2826104164123535
3.282442092895508
3.2821245193481445
3.2825660705566406
3.282168388366699
3.2825052738189697
3.2826461791992188
3.2820844650268555
3.2825698852539062
3.282076835632324
3.282888412475586
3.2822155952453613
3.2821030616760254
3.2826359272003174
3.282015800476074
3.2824816703796387
3.282501697540283
3.2825589179992676
3.282137870788574
3.2819437980651855
3.28242826461792
3.2820043563842773
3.2826132774353027
3.2818455696105957
3.282339096069336
3.282242774963379
3.282346248626709
3.282057762145996
3.2819013595581055
3.2822070121765137
3.28233003616333
3.2825329303741455
3.2820000648498535
3.2820043563842773
3.282261848449707
3.282388687133789
3.2819371223449707
3.2822790145874023
3.2822928428649902
3.2823801040649414
3.2825095653533936
3.2821805477142334
3.282593250274658
3.282020092010498
3.282465934753418
3.282745838165283
3.282320022583008
3.282315492630005
3.2819926738739014
3.2822999954223633
3.281794786453247
3.282595634460449
3.2819442749023438
3.2820401191711426
3.2821617126464844
3.282834529876709
3.282350540161133
3.2821388244628906
3.282435417175293
3.282057523727417
3.2818593978881836
3.282386302947998
3.2821037769317627
3.282467842102051
3.282536029815674
3.2821121215820312
3.2819414138793945
3.2822282314300537
3.2826571464538574
3.282132625579834
3.2823848724365234
3.2828187942504883
3.2821757793426514
3.281857490539551
3.282306432723999
3.282228946685791
3.2821054458618164
3.2823212146759033
3.2820048332214355
3.2825589179992676
3.2821097373962402
3.28236722946167
3.282247543334961
3.2825539112091064
3.2824583053588867
3.2819972038269043
3.2820723056793213
3.2820186614990234
3.2822251319885254
3.2825076580047607
3.282176971435547
3.282254934310913
3.282569408416748
3.2819876670837402
3.282149314880371
3.2820467948913574
3.281857967376709
3.2825064659118652
3.282010078430176
3.2818245887756348
3.2820873260498047
3.282135009765625
3.282353401184082
3.2825231552124023
3.2823095321655273
3.2818045616149902
3.2822883129119873
3.2823543548583984
3.2822203636169434
3.282116174697876
3.282179117202759
3.28220534324646
3.282226085662842
3.2827413082122803
3.2822439670562744
3.2822606563568115
3.282276153564453
3.282216787338257
3.2822070121765137
3.2818942070007324
3.282259464263916
3.282407283782959
3.282526969909668
3.2822265625
3.2823805809020996
3.282472610473633
3.282313585281372
3.282132625579834
3.282236099243164
3.282193660736084
3.2820990085601807
3.2821311950683594
3.2820851802825928
3.2825913429260254
3.282162666320801
3.282660484313965
3.282291889190674
3.2823123931884766
3.2821764945983887
3.282176971435547
3.2819995880126953
3.2823824882507324
3.282538414001465
3.2820496559143066
3.2821133136749268
3.282430648803711
3.2828476428985596
3.2823119163513184
3.2820868492126465
3.2822751998901367
3.2823386192321777
3.282541275024414
3.2820639610290527
3.2819414138793945
3.282093048095703
3.2826974391937256
3.2822952270507812
3.2821831703186035
3.2823781967163086
3.2824811935424805
3.2825589179992676
3.2828330993652344
3.2820754051208496
3.282480239868164
3.2828457355499268
3.2820801734924316
3.2823104858398438
3.282589912414551
3.282496690750122
3.2822141647338867
3.282407760620117
3.2820606231689453
3.2823212146759033
3.2824244499206543
3.282156229019165
3.2826640605926514
3.282400131225586
3.282003879547119
3.282486915588379
3.282444953918457
3.282527446746826
3.2820215225219727
3.281834840774536
3.2820801734924316
3.281965970993042
3.282339096069336
3.2821743488311768
3.28214955329895
3.2821993827819824
3.2821593284606934
3.282280206680298
3.2821054458618164
3.282186985015869
3.2823235988616943
3.2825968265533447
3.2821712493896484
3.282116651535034
3.2822465896606445
3.282623291015625
3.2824063301086426
3.2821123600006104
3.2822515964508057
3.2825446128845215
3.281977415084839
3.2820422649383545
3.282339572906494
3.2825117111206055
3.282599449157715
3.282130241394043
3.2823081016540527
3.282412528991699
3.2821297645568848
3.2819600105285645
3.282304286956787
3.282357931137085
3.2822084426879883
3.2822327613830566
3.282240629196167
3.2824606895446777
3.282464027404785
3.282283306121826
3.281804084777832
3.2821664810180664
3.2820897102355957
3.2824573516845703
3.281613826751709
3.2824087142944336
3.28259015083313
3.2820897102355957
3.282270669937134
3.282454490661621
3.2824769020080566
3.2821903228759766
3.2828545570373535
3.281996250152588
3.2823753356933594
3.2820234298706055
3.2824511528015137
3.2825734615325928
3.2822628021240234
3.28240704536438
3.2819979190826416
3.281947135925293
3.2824349403381348
3.2823424339294434
3.282521963119507
3.282200336456299
3.2823145389556885
3.2819395065307617
3.2819740772247314
3.2825493812561035
3.282223701477051
3.282252311706543
3.282674551010132
3.282076358795166
3.281757354736328
3.282526969909668
3.2821578979492188
3.282093048095703
3.2825183868408203
3.28206205368042
3.2821826934814453
3.282013177871704
3.2823586463928223
3.28256893157959
3.2824201583862305
3.2821860313415527
3.2820448875427246
3.281975030899048
3.2824020385742188
3.282200813293457
3.2824318408966064
3.28236722946167
3.282045841217041
3.2819652557373047
3.2821593284606934
3.2823753356933594
3.28257155418396
3.281834840774536
3.2817392349243164
3.2826828956604004
3.2826271057128906
3.282561779022217
3.2823188304901123
3.2819132804870605
3.282447099685669
3.281961441040039
3.282339572906494
3.282166004180908
3.2823734283447266
3.2823705673217773
3.282515048980713
3.281904697418213
3.282165050506592
3.281985282897949
3.2820966243743896
3.2824134826660156
3.282756805419922
3.282010078430176
3.2822532653808594
3.2823472023010254
3.282142162322998
3.282360553741455
3.2819271087646484
3.282242774963379
3.282101631164551
3.2818706035614014
3.282115936279297
3.2821614742279053
3.2822818756103516
3.2822935581207275
3.2821035385131836
3.2821853160858154
3.2826709747314453
3.2821044921875
3.2821669578552246
3.2821123600006104
3.2820420265197754
3.2820756435394287
3.282566547393799
3.282111644744873
3.281846284866333
3.2820990085601807
3.2822141647338867
3.2824108600616455
3.282087802886963
3.2820866107940674
3.282541275024414
3.282097339630127
3.2818942070007324
3.282398223876953
3.281996726989746
3.2822632789611816
3.282074451446533
3.282459259033203
3.281991481781006
3.282477855682373
3.282264232635498
3.2825517654418945
3.2822327613830566
3.282395362854004
3.2821924686431885
3.282362937927246
3.2821695804595947
3.2822837829589844
3.2824559211730957
3.282116413116455
3.2822532653808594
3.2824878692626953
3.282498836517334
3.2824599742889404
3.2820940017700195
3.2827162742614746
3.282618522644043
3.282060146331787
3.2820327281951904
3.2824721336364746
3.2823824882507324
3.281867742538452
3.282174825668335
3.2817955017089844
3.2821950912475586
3.281984329223633
3.282505989074707
3.2823591232299805
3.2819104194641113
3.282531499862671
3.282597303390503
3.2821402549743652
3.2824032306671143
3.281740188598633
3.282235622406006
3.28253173828125
3.281841993331909
3.281907558441162
3.2823686599731445
3.2825698852539062
3.2821531295776367
3.2823233604431152
3.2822999954223633
3.282503128051758
3.2824478149414062
3.2822210788726807
3.282252311706543
3.282377004623413
3.282162666320801
3.2821688652038574
3.2822203636169434
3.282273292541504
3.282443046569824
3.2821807861328125
3.282193899154663
3.282449245452881
3.2822279930114746
3.28262996673584
3.2819583415985107
3.2819652557373047
3.2825570106506348
3.2825405597686768
3.2824959754943848
3.2822470664978027
3.2821011543273926
3.2822906970977783
3.281775951385498
3.282409191131592
3.282458543777466
3.2822165489196777
3.282594680786133
3.281991481781006
3.2823970317840576
3.2822585105895996
3.2822160720825195
3.282496452331543
3.2823219299316406
3.2824816703796387
3.2827110290527344
3.282283306121826
3.2821216583251953
3.2818174362182617
3.2825398445129395
3.281748056411743
3.2821805477142334
3.282684326171875
3.282231330871582
3.2823853492736816
3.2824316024780273
3.282221794128418
3.2822659015655518
3.282259941101074
3.282393217086792
3.2822322845458984
3.2820544242858887
3.2822208404541016
3.2823920249938965
3.282226085662842
3.2820651531219482
3.282465934753418
3.28228497505188
3.2823262214660645
3.2820141315460205
3.2821593284606934
3.2822351455688477
3.2821121215820312
3.281919479370117
3.2819595336914062
3.282433032989502
3.28290057182312
3.2820258140563965
3.282205581665039
3.28238844871521
3.282101631164551
3.2818517684936523
3.282184600830078
3.2822306156158447
3.2825534343719482
3.2821202278137207
3.2819621562957764
3.2823338508605957
3.282374858856201
3.28212308883667
3.282456874847412
3.2824113368988037
3.282036781311035
3.281956434249878
3.282313108444214
3.2818775177001953
3.2825546264648438
3.28238844871521
3.282343626022339
3.2821130752563477
3.2822935581207275
3.2822232246398926
3.2824440002441406
3.282416343688965
3.282167434692383
3.2823357582092285
3.2826435565948486
3.281743049621582
3.2822446823120117
3.282043933868408
3.2826104164123535
3.2823679447174072
3.2825698852539062
3.282353639602661
3.2820205688476562
3.281716823577881
3.2825098037719727
3.282614231109619
3.2825264930725098
3.2826223373413086
3.2824501991271973
3.282313108444214
3.2822020053863525
3.282406806945801
3.2827377319335938
3.281785488128662
3.28212833404541
3.282485008239746
3.2822437286376953
3.2821531295776367
3.282374382019043
3.281960964202881
3.282472848892212
3.281752586364746
3.2825493812561035
3.2822771072387695
3.282081127166748
3.2819955348968506
3.282341241836548
3.2825498580932617
3.28192138671875
3.2822275161743164
3.2821760177612305
3.2822306156158447
3.2823429107666016
3.281679153442383
3.282365322113037
3.2823283672332764
3.28206729888916
3.282055616378784
3.282175302505493
3.2821133136749268
3.28265380859375
3.282454013824463
3.282304048538208
3.2819743156433105
3.2823619842529297
3.282637596130371
3.2826621532440186
3.2825117111206055
3.282494306564331
3.28196382522583
3.2823486328125
3.2820382118225098
3.281938314437866
3.2823708057403564
3.282367706298828
3.282158374786377
3.28188419342041
3.2821598052978516
3.282109498977661
3.28214955329895
3.2825186252593994
3.28240704536438
3.2825732231140137
3.281937837600708
3.282240152359009
3.282525062561035
3.2821145057678223
3.2823667526245117
3.282182455062866
3.282172918319702
3.2823455333709717
3.281916856765747
3.282675266265869
3.2821803092956543
3.282491683959961
3.282052993774414
3.2821078300476074
3.282299518585205
3.282749891281128
3.282594680786133
3.2821168899536133
3.2822041511535645
3.2825968265533447
3.282310962677002
3.282355308532715
3.2821245193481445
3.282247543334961
3.282660961151123
3.2823643684387207
3.282013416290283
3.282357692718506
3.28227162361145
3.2824158668518066
3.282487392425537
3.2821850776672363
3.282089948654175
3.2820591926574707
3.282294273376465
3.2820305824279785
3.282543897628784
3.2821898460388184
3.2823500633239746
3.2823944091796875
3.2821531295776367
3.2820661067962646
3.282776355743408
3.2821929454803467
3.282257556915283
3.282370090484619
3.2821154594421387
3.2819366455078125
3.2823245525360107
3.2822341918945312
3.28225040435791
3.2822556495666504
3.28225040435791
3.2823915481567383
3.28206729888916
3.282193660736084
3.282710075378418
3.2824652194976807
3.2818853855133057
3.2819457054138184
3.2823662757873535
3.2822790145874023
3.282637119293213
3.2821218967437744
3.2819390296936035
3.2823972702026367
3.2824926376342773
3.282468795776367
3.2821097373962402
3.282350778579712
3.282039165496826
3.282392978668213
3.282501697540283
3.28212308883667
3.2826156616210938
3.2823939323425293
3.2824063301086426
3.2820701599121094
3.282423496246338
3.2826151847839355
3.28214168548584
3.282587766647339
3.2822701930999756
3.2823421955108643
3.2827601432800293
3.282453775405884
3.2822699546813965
3.2825989723205566
3.28242826461792
3.282224655151367
3.2823634147644043
3.2823386192321777
3.2823221683502197
3.2821762561798096
3.2821693420410156
3.2821624279022217
3.282447338104248
3.282459259033203
3.2824041843414307
3.282339096069336
3.282402992248535
3.2820003032684326
3.2822394371032715
3.282449245452881
3.282533884048462
3.2822837829589844
3.2821006774902344
3.2820334434509277
3.2822132110595703
3.282022476196289
3.282442569732666
3.2822582721710205
3.282248020172119
3.282106876373291
3.2819530963897705
3.2818078994750977
3.2822399139404297
3.2820959091186523
3.282231330871582
3.2827086448669434
3.282255172729492
3.28236722946167
3.2823212146759033
3.2820916175842285
3.2828454971313477
3.2821338176727295
3.282482147216797
3.282108783721924
3.282334327697754
3.282588005065918
3.2822442054748535
3.282243251800537
3.2822883129119873
3.2819666862487793
3.2820801734924316
3.2822859287261963
3.281942844390869
3.2820310592651367
3.2822985649108887
3.2821786403656006
3.282196521759033
3.2820076942443848
3.2822766304016113
3.282332181930542
3.282149314880371
3.282388687133789
3.2823007106781006
3.282332420349121
3.2822093963623047
3.28226375579834
3.282564163208008
3.281937837600708
3.2821719646453857
3.282616138458252
3.2819013595581055
3.2818102836608887
3.2818312644958496
3.2822771072387695
3.2826383113861084
3.2822537422180176
3.282360076904297
3.2822911739349365
3.2819552421569824
3.282261610031128
3.281980514526367
3.2822108268737793
3.2820072174072266
3.28224515914917
3.282104015350342
3.282278299331665
3.2826380729675293
3.2824323177337646
3.282270908355713
Traceback (most recent call last):
  File "c:\Users\gizem\Documents\GitHub\noisy_fair\margin_no_imb.py", line 431, in <module>
    margin_classifiers_perf(d=5000,n=200,approx_tau=1, SNR=10, n_test=1e4, s=1, l1=True)
  File "c:\Users\gizem\Documents\GitHub\noisy_fair\margin_no_imb.py", line 293, in margin_classifiers_perf
    l = loss_average_poly(w, b, z1s, z2s, n1, n2) + torch.norm(w, p=1)
  File "c:\Users\gizem\Documents\GitHub\noisy_fair\margin_no_imb.py", line 26, in loss_average_poly
    return (torch.sum(1./(z1s @ v)) + b * torch.sum(1./(z2s @ v))) /(n1+b*n2)
  File "C:\Users\gizem\anaconda3\envs\iw\lib\site-packages\torch\_tensor.py", line 26, in wrapped
    @functools.wraps(f, assigned=assigned)
KeyboardInterrupt