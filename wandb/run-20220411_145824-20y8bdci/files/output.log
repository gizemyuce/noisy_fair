C:\Users\gizem\anaconda3\envs\iw\lib\site-packages\sklearn\svm\_base.py:1206: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations.
  warnings.warn(
tensor([ 0.0305, -0.0030,  0.0063,  ...,  0.0063, -0.0048,  0.0017])
CMM train_err=0.0, err=45.01499938964844
tensor([nan, nan, nan,  ..., nan, nan, nan], requires_grad=True)
w=1.0, train_err=100.0, err=100.0
tensor([nan, nan, nan,  ..., nan, nan, nan], requires_grad=True)
w=1.0, train_err=100.0, err=100.0
tensor([nan, nan, nan,  ..., nan, nan, nan], requires_grad=True)
w=1.0, train_err=100.0, err=100.0
====================l1=========================
CMM train_err=0.0, err=6.3550004959106445
35558.10546875
13820.962890625
217700.1875
175805.953125
250332.40625
206473.671875
168502.421875
136204.53125
109179.828125
89472.703125
67925.0546875
52480.55859375
41116.82421875
30429.65625
22923.865234375
17185.744140625
12675.2099609375
9168.10546875
1568223.25
1519597.25
1471835.25
1425035.75
1379202.125
1334370.0
1290511.75
1247641.625
1205650.375
1164530.0
1124491.25
1085499.375
1047493.125
1010462.375
974432.4375
939214.6875
904930.125
871770.375
839571.125
810043.0
778194.0625
748506.875
719740.875
691751.125
664719.5625
638434.5
613005.125
588389.6875
564589.1875
541589.625
519312.625
497724.71875
476772.34375
456430.625
436672.84375
417756.1875
399613.9375
382146.125
365286.84375
348823.0625
333051.65625
317862.78125
303150.90625
289082.125
275544.3125
262487.5625
249904.828125
237802.0625
226273.671875
215242.625
204607.578125
194390.6875
184627.5625
175166.65625
166054.390625
157257.65625
148807.71875
140770.875
133057.140625
125629.1796875
118552.625
114935.453125
105558.71875
99581.03125
93942.9921875
88529.34375
83385.28125
260126.765625
215032.3125
178076.53125
147293.328125
121908.640625
102185.40625
86308.375
76916.578125
64434.93359375
56319.12890625
57871.18359375
Traceback (most recent call last):
  File "c:\Users\gizem\Documents\GitHub\noisy_fair\margin.py", line 432, in <module>
    margin_classifiers_perf(d=5000,n=200,approx_tau=1, SNR=10, n_test=1e4, s=1, l1=True)
  File "c:\Users\gizem\Documents\GitHub\noisy_fair\margin.py", line 290, in margin_classifiers_perf
    l = loss_average_poly(w, b, z1s, z2s, n1, n2) + torch.norm(w, p=1)
  File "c:\Users\gizem\Documents\GitHub\noisy_fair\margin.py", line 26, in loss_average_poly
    return (torch.sum(1./(z1s @ v)) + b * torch.sum(1./(z2s @ v))) /(n1+b*n2)
  File "C:\Users\gizem\anaconda3\envs\iw\lib\site-packages\torch\_tensor.py", line 31, in wrapped
    return f(*args, **kwargs)
KeyboardInterrupt