[-1.  1. -1.  1.  1.  1. -1.  1.  1.  1.  1.  1. -1. -1.  1. -1.  1. -1.
  1. -1. -1.  1.  1.  1.  1.  1. -1.  1. -1.  1. -1.  1.  1. -1.  1. -1.
  1.  1.  1. -1.  1. -1. -1. -1.  1. -1.  1.  1. -1. -1.  1.  1. -1.  1.
  1. -1. -1. -1.  1. -1. -1.  1.  1.  1. -1.  1. -1. -1. -1.  1.  1.  1.
 -1. -1. -1.  1. -1. -1.  1. -1.  1.  1.  1. -1.  1. -1.  1.  1. -1.  1.
  1.  1.  1. -1.  1. -1. -1.  1.  1.  1.  1. -1.  1.  1. -1. -1. -1. -1.
 -1. -1.  1. -1.  1. -1.  1.  1.  1. -1.  1. -1. -1.  1. -1. -1. -1. -1.
  1.  1. -1. -1.  1.  1.  1.  1.  1.  1. -1.  1.  1.  1. -1.  1. -1.  1.
 -1.  1. -1. -1.  1. -1.  1.  1.  1.  1. -1. -1.  1.  1. -1. -1.  1. -1.
 -1. -1.  1. -1. -1.  1.  1. -1.  1.  1. -1. -1.  1. -1. -1.  1.  1.  1.
  1.  1. -1. -1. -1.  1.  1. -1.  1.  1. -1. -1. -1. -1. -1.  1.  1.  1.
  1. -1.]
Traceback (most recent call last):
  File "c:\Users\gizem\Documents\GitHub\noisy_fair\margin.py", line 227, in <module>
    main(d=2,n=100,approx_tau=8, SNR=10, n_test=1e4, s=1)
  File "c:\Users\gizem\Documents\GitHub\noisy_fair\margin.py", line 168, in main
    xs, ys, x_seq_test, y_seq_test, z1s, z2s = create_data_sparse(d,n1,n2,n_test, s=1, random_flip_prob=0.05)
  File "c:\Users\gizem\Documents\GitHub\noisy_fair\margin.py", line 121, in create_data_sparse
    y_seq[noise_mask==1 and y_seq==0] = 1
RuntimeError: Boolean value of Tensor with more than one value is ambiguous